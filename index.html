<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Calculadora de Massa - Pizzas / Farinha / Levain %</title>
  <style>
    body { font-family: Arial, Helvetica, sans-serif; margin: 20px; background: #f9f9f9; color: #333; }
    h1 { text-align: center; color: #2c3e50; }
    .container { max-width: 1200px; margin: 0 auto; }
    .inputs, .filters { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
    .input-group { display: flex; align-items: center; gap: 15px; margin: 15px 0; flex-wrap: wrap; }
    label { font-weight: bold; min-width: 240px; }
    input, select { padding: 8px 12px; font-size: 1.05em; border: 1px solid #ccc; border-radius: 6px; }
    input[type="number"] { width: 140px; }
    input[type="range"] { width: 200px; }
    button { padding: 10px 24px; background: #34495e; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1.05em; }
    button:hover { background: #1e3a5f; }
    .mode-info { font-size: 1.1em; margin: 15px 0; color: #444; }
    .warning { color: #c0392b; font-weight: bold; }
    table { width: 100%; border-collapse: collapse; background: white; box-shadow: 0 3px 12px rgba(0,0,0,0.12); }
    th, td { padding: 12px; text-align: center; border: 1px solid #ddd; }
    th { background: #34495e; color: white; }
    tr:nth-child(even) { background: #f8fbff; }
    tr.hidden { display: none; }
    .no-results { text-align: center; padding: 40px; color: #777; font-style: italic; }
  </style>
</head>
<body>

<div class="container">
  <h1>Calculadora de Massa para Pizzas</h1>

  <div class="inputs">
    <h3>Modo de cálculo</h3>
    
    <div class="input-group">
      <label for="farinhaBase">Modo 1 – Farinha base (FA) em gramas:</label>
      <input type="number" id="farinhaBase" placeholder="ex: 1000" min="100" step="10">
      <span style="color: #666; font-size: 0.95em;">(farinha adicionada diretamente)</span>
    </div>

    <div class="input-group">
      <label for="numPizzas">Modo 2 – Quantidade de pizzas:</label>
      <input type="number" id="numPizzas" placeholder="ex: 8" min="1" step="1" style="width:100px;">
      <label for="pesoPizza" style="min-width:auto;">Peso por pizza (g):</label>
      <input type="number" id="pesoPizza" placeholder="300" min="50" step="10" value="300" style="width:100px;">
    </div>

    <div class="input-group">
      <label for="levainPct">Percentual de levain (% da farinha base FA):</label>
      <input type="number" id="levainPct" min="10" max="50" step="5" value="20" style="width:100px;">
      <input type="range" id="levainSlider" min="10" max="50" step="5" value="20">
      <span id="levainValue">20%</span>
    </div>

    <div class="input-group">
      <label for="salPct">Percentual de sal (% da farinha total):</label>
      <input type="number" id="salPct" min="2" max="4" step="0.5" value="3" style="width:100px;">
      <input type="range" id="salSlider" min="2" max="4" step="0.5" value="3">
      <span id="salValue">3%</span>
    </div>

    <div class="input-group">
      <button onclick="calcular()">Calcular</button>
    </div>

    <div id="modoInfo" class="mode-info"></div>
  </div>

  <div class="filters">
    <div class="input-group">
      <label for="hidratacao">Hidratação desejada (HI):</label>
      <select id="hidratacao">
        <option value="todos">Todos</option>
        <option value="60">60%</option>
        <option value="65">65%</option>
        <option value="70">70%</option>
        <option value="75">75%</option>
        <option value="80">80%</option>
      </select>
    </div>
    <div class="input-group">
      <label for="tipoLevain">Tipo de Levain (isca:água:farinha):</label>
      <select id="tipoLevain">
        <option value="todos">Todos</option>
        <option value="1:1:1">1:1:1</option>
        <option value="1:2:2">1:2:2</option>
        <option value="1:2:3">1:2:3</option>
        <option value="1:4:4">1:4:4</option>
        <option value="1:5:5">1:5:5</option>
      </select>
    </div>
  </div>

  <div id="resultado" class="mode-info"></div>

  <table id="tabela">
    <thead>
      <tr>
        <th>Hidratação (HI)</th>
        <th>Levain %</th>
        <th>Tipo Levain</th>
        <th>Farinha Base FA (g)</th>
        <th>Levain Total (g)</th>
        <th>Água Adicional (g)</th>
        <th>Sal %</th>
        <th>Sal (g)</th>
        <th>Farinha no Levain (g)</th>
        <th>Farinha Total (g)</th>
        <th>Água no Levain (g)</th>
        <th>Água Total (g)</th>
        <th>Massa Total (g)</th>
      </tr>
    </thead>
    <tbody id="tbody"></tbody>
  </table>

  <div id="noResults" class="no-results hidden">Nenhuma combinação encontrada.</div>
</div>

<script>
// Sincronizar slider e input de % levain
const levainInput = document.getElementById("levainPct");
const levainSlider = document.getElementById("levainSlider");
const levainValue = document.getElementById("levainValue");

function updateLevain(val) {
  val = Math.max(10, Math.min(50, val));
  levainInput.value = val;
  levainSlider.value = val;
  levainValue.textContent = val + "%";
}

levainInput.addEventListener("input", () => updateLevain(levainInput.value));
levainSlider.addEventListener("input", () => updateLevain(levainSlider.value));

// Sincronizar slider e input de % sal
const salInput = document.getElementById("salPct");
const salSlider = document.getElementById("salSlider");
const salValue = document.getElementById("salValue");

function updateSal(val) {
  val = Math.max(2, Math.min(4, val));
  salInput.value = val;
  salSlider.value = val;
  salValue.textContent = val + "%";
}

salInput.addEventListener("input", () => updateSal(salInput.value));
salSlider.addEventListener("input", () => updateSal(salSlider.value));

// Dados base – combinações de hidratação e tipo de levain
const combinacoes = [
  {hid: 60, tipo: "1:1:1"},
  {hid: 60, tipo: "1:2:2"},
  {hid: 60, tipo: "1:2:3"},
  {hid: 60, tipo: "1:4:4"},
  {hid: 60, tipo: "1:5:5"},
  {hid: 65, tipo: "1:1:1"},
  {hid: 65, tipo: "1:2:2"},
  {hid: 65, tipo: "1:2:3"},
  {hid: 65, tipo: "1:4:4"},
  {hid: 65, tipo: "1:5:5"},
  {hid: 70, tipo: "1:1:1"},
  {hid: 70, tipo: "1:2:2"},
  {hid: 70, tipo: "1:2:3"},
  {hid: 70, tipo: "1:4:4"},
  {hid: 70, tipo: "1:5:5"},
  {hid: 75, tipo: "1:1:1"},
  {hid: 75, tipo: "1:2:2"},
  {hid: 75, tipo: "1:2:3"},
  {hid: 75, tipo: "1:4:4"},
  {hid: 75, tipo: "1:5:5"},
  {hid: 80, tipo: "1:1:1"},
  {hid: 80, tipo: "1:2:2"},
  {hid: 80, tipo: "1:2:3"},
  {hid: 80, tipo: "1:4:4"},
  {hid: 80, tipo: "1:5:5"}
];

function calcular() {
  const farinhaBase = parseFloat(document.getElementById("farinhaBase").value) || 0;
  const numPizzas = parseFloat(document.getElementById("numPizzas").value) || 0;
  const pesoPizza = parseFloat(document.getElementById("pesoPizza").value) || 300;
  const levainPct = parseFloat(document.getElementById("levainPct").value) / 100 || 0.20;
  const salPct = parseFloat(document.getElementById("salPct").value) / 100 || 0.03;

  const modoInfo = document.getElementById("modoInfo");
  const resultado = document.getElementById("resultado");
  const tbody = document.getElementById("tbody");
  tbody.innerHTML = "";

  let modo = "";

  // Validação: apenas um modo deve ser preenchido
  if (farinhaBase > 0 && numPizzas > 0) {
    modoInfo.innerHTML = '<span class="warning">Escolha APENAS um modo: farinha OU pizzas.</span>';
    return;
  }

  // Modo FARINHA BASE (FA)
  if (farinhaBase > 0) {
    modo = "farinha";
    modoInfo.innerHTML = `Modo FARINHA: <strong>${farinhaBase} g de farinha base (FA)</strong> + levain ${Math.round(levainPct*100)}% da FA`;
    resultado.innerHTML = "Cálculo conforme fórmulas: Levain = FA × %levain | Água Adicional = FA × HI - Água do Levain | Sal = %sal × Farinha Total";
  }
  // Modo PIZZAS
  else if (numPizzas > 0) {
    modo = "pizzas";
    const massaTotalReferencia = numPizzas * pesoPizza;
    modoInfo.innerHTML = `Modo PIZZAS: <strong>${numPizzas} pizzas</strong> de <strong>${pesoPizza}g</strong> (${massaTotalReferencia} g total)`;
    resultado.innerHTML = "Calculando farinha base (FA) necessária para atingir a massa total desejada.";
  } else {
    modoInfo.innerHTML = "Informe farinha base (FA) OU número de pizzas.";
    return;
  }

  // Para cada combinação de hidratação e tipo de levain
  combinacoes.forEach(d => {
    const hidratacaoDesejada = d.hid / 100;
    
    // Proporções de farinha e água no levain conforme o tipo
    // Tipo = isca:água:farinha
    let farinhaLevainRatio, aguaLevainRatio;
    
    switch(d.tipo) {
      case "1:1:1":
        // isca:água:farinha = 1:1:1 → farinha = 1 parte, água = 1 parte, total = 2 partes
        farinhaLevainRatio = 0.5; // farinha = 1/2 do total (água+farinha)
        aguaLevainRatio = 0.5;    // água = 1/2 do total (água+farinha)
        break;
      case "1:2:2":
        // isca:água:farinha = 1:2:2 → farinha = 2 partes, água = 2 partes, total = 4 partes
        farinhaLevainRatio = 0.5; // farinha = 2/4 = 0.5
        aguaLevainRatio = 0.5;    // água = 2/4 = 0.5
        break;
      case "1:2:3":
        // isca:água:farinha = 1:2:3 → farinha = 3 partes, água = 2 partes, total = 5 partes
        farinhaLevainRatio = 3/5; // farinha = 3/5 = 0.6
        aguaLevainRatio = 2/5;    // água = 2/5 = 0.4
        break;
      case "1:4:4":
        // isca:água:farinha = 1:4:4 → farinha = 4 partes, água = 4 partes, total = 8 partes
        farinhaLevainRatio = 0.5; // farinha = 4/8 = 0.5
        aguaLevainRatio = 0.5;    // água = 4/8 = 0.5
        break;
      case "1:5:5":
        // isca:água:farinha = 1:5:5 → farinha = 5 partes, água = 5 partes, total = 10 partes
        farinhaLevainRatio = 0.5; // farinha = 5/10 = 0.5
        aguaLevainRatio = 0.5;    // água = 5/10 = 0.5
        break;
      default:
        farinhaLevainRatio = 0.5;
        aguaLevainRatio = 0.5;
    }

    let farinhaFA = 0;          // Farinha base (FA) - entrada do usuário
    let farinhaNoLevain = 0;    // Farinha que vem do levain
    let farinhaTotal = 0;       // Farinha total = FA + farinha do levain
    let levainTotal = 0;        // Levain total em gramas
    let aguaNoLevain = 0;       // Água que vem do levain
    let aguaAdicional = 0;      // Água adicional a ser adicionada (FA × HI - Água do Levain)
    let aguaTotal = 0;          // Água total = água no levain + água adicional
    let sal = 0;               // Sal em gramas (% da farinha total)
    let massaTotal = 0;        // Massa total = soma de todos os componentes

    if (modo === "farinha") {
      // MODO FARINHA: FA é o valor de entrada
      farinhaFA = farinhaBase;
      
      // 1. LEVAIN TOTAL = FA × %levain
      levainTotal = farinhaFA * levainPct;
      
      // 2. FARINHA NO LEVAIN = Levain Total × farinhaLevainRatio
      farinhaNoLevain = levainTotal * farinhaLevainRatio;
      
      // 3. FARINHA TOTAL = FA + Farinha no Levain
      farinhaTotal = farinhaFA + farinhaNoLevain;
      
      // 4. ÁGUA NO LEVAIN = Levain Total × aguaLevainRatio
      aguaNoLevain = levainTotal * aguaLevainRatio;
      
      // 5. ÁGUA ADICIONAL = FA × HI - Água do Levain
      aguaAdicional = (farinhaFA * hidratacaoDesejada) - aguaNoLevain;
      
      // 6. ÁGUA TOTAL = Água no Levain + Água Adicional
      aguaTotal = aguaNoLevain + aguaAdicional;
      
      // 7. SAL = Farinha Total × %sal
      sal = farinhaTotal * salPct;
      
      // 8. MASSA TOTAL = FarinhaTotal + ÁguaTotal + LevainTotal + Sal
      massaTotal = farinhaTotal + aguaTotal + levainTotal + sal;
      
    } else { 
      // MODO PIZZAS: calcular FA a partir da massa total desejada
      const massaTotalReferencia = numPizzas * pesoPizza;
      
      // Equação completa para encontrar FA:
      // Massa = FarinhaTotal + AguaTotal + LevainTotal + Sal
      // Onde:
      // FarinhaTotal = FA + (FA × levainPct × farinhaLevainRatio) = FA × (1 + levainPct × farinhaLevainRatio)
      // AguaTotal = FA × HI (pois AguaAdicional + AguaNoLevain = FA × HI)
      // LevainTotal = FA × levainPct
      // Sal = FarinhaTotal × salPct = FA × (1 + levainPct × farinhaLevainRatio) × salPct
      
      // Massa = [FA × (1 + levainPct × farinhaLevainRatio)] + [FA × HI] + [FA × levainPct] + [FA × (1 + levainPct × farinhaLevainRatio) × salPct]
      // Massa = FA × [(1 + levainPct × farinhaLevainRatio) × (1 + salPct) + HI + levainPct]
      
      const fatorFarinhaTotal = 1 + (levainPct * farinhaLevainRatio);
      const denominador = (fatorFarinhaTotal * (1 + salPct)) + hidratacaoDesejada + levainPct;
      
      let farinhaFACalc = massaTotalReferencia / denominador;
      
      // Cálculos precisos com o valor encontrado
      farinhaFA = farinhaFACalc;
      levainTotal = farinhaFA * levainPct;
      farinhaNoLevain = levainTotal * farinhaLevainRatio;
      farinhaTotal = farinhaFA + farinhaNoLevain;
      aguaNoLevain = levainTotal * aguaLevainRatio;
      aguaAdicional = (farinhaFA * hidratacaoDesejada) - aguaNoLevain;
      aguaTotal = aguaNoLevain + aguaAdicional;
      sal = farinhaTotal * salPct;
      massaTotal = farinhaTotal + aguaTotal + levainTotal + sal;
    }

    // Arredondar valores para exibição
    const tr = document.createElement("tr");
    tr.setAttribute("data-hid", d.hid);
    tr.setAttribute("data-tipo", d.tipo);
    tr.innerHTML = `
      <td>${d.hid}%</td>
      <td>${Math.round(levainPct * 100)}%</td>
      <td>${d.tipo}</td>
      <td>${Math.round(farinhaFA)}</td>
      <td>${Math.round(levainTotal)}</td>
      <td>${Math.round(aguaAdicional)}</td>
      <td>${(salPct * 100).toFixed(1)}%</td>
      <td>${Math.round(sal)}</td>
      <td>${Math.round(farinhaNoLevain)}</td>
      <td>${Math.round(farinhaTotal)}</td>
      <td>${Math.round(aguaNoLevain)}</td>
      <td>${Math.round(aguaTotal)}</td>
      <td>${Math.round(massaTotal)}</td>
    `;
    tbody.appendChild(tr);
  });

  filterTable();
}

function filterTable() {
  const hid = document.getElementById("hidratacao").value;
  const tipo = document.getElementById("tipoLevain").value;
  const rows = document.querySelectorAll("#tabela tbody tr");
  let visiveis = 0;

  rows.forEach(row => {
    const matchHid = (hid === "todos" || row.getAttribute("data-hid") === hid);
    const matchTipo = (tipo === "todos" || row.getAttribute("data-tipo") === tipo);
    if (matchHid && matchTipo) {
      row.classList.remove("hidden");
      visiveis++;
    } else {
      row.classList.add("hidden");
    }
  });

  document.getElementById("noResults").classList.toggle("hidden", visiveis > 0);
}

document.getElementById("hidratacao").addEventListener("change", filterTable);
document.getElementById("tipoLevain").addEventListener("change", filterTable);
</script>

</body>
</html>
